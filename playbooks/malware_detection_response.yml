name: malware_detection_response
description: Automated response to malware detection on a host
trigger:
  event_type: malware_detected
  severity: high

actions:
  - type: send_alert
    name: notify_soc_team
    params:
      severity: high
      message: "Malware detected - automated response initiated"
      channels:
        - email
        - slack
    
  - type: isolate_host
    name: isolate_infected_host
    params:
      hostname: ${hostname}
    condition: "severity >= 7"
    
  - type: quarantine_file
    name: quarantine_malware
    params:
      file_path: ${file_path}
      file_hash: ${file_hash}
    
  - type: collect_evidence
    name: collect_forensics
    params:
      hostname: ${hostname}
      artifacts:
        - memory
        - disk
        - network
    continue_on_failure: true
    
  - type: create_ticket
    name: create_incident_ticket
    params:
      title: "Malware Detection - ${hostname}"
      description: "Malware detected on ${hostname}. File: ${file_path}. Hash: ${file_hash}"
      priority: high

metadata:
  author: Nexus-Sec
  version: 1.0
  tags:
    - malware
    - endpoint
    - automated_response
